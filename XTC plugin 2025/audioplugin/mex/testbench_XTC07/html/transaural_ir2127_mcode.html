<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="38,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T35U3">cLL</span>,<span class="var type1" id="S3T35U4">cRL</span>, <span class="var type1" id="S4T35U5">cLR</span>, <span class="var type1" id="S5T35U6">cRR</span>, <span class="var type1" id="S6T36U7">t</span>, <span class="var type1" id="S7T3U8">dt</span>, <span class="var type0" id="S8T0U9">C2</span>, <span class="var type0" id="S9T0U10">H2</span>] = transaural_ir2(<span class="var type1" id="S10T3U13">D</span>,<span class="var type1" id="S11T3U14">dp</span>,<span class="var type1" id="S12T3U15">do</span>,<span class="var type1" id="S13T3U16">beta</span>,<span class="var type1" id="S14T3U17">nSamplesIR</span>,<span class="var type1" id="S15T3U18">fs</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="38,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">% [cLL,cRL, cLR, cRR, t, dt] = transaural_ir(D,dp,do,beta,nSamplesIR,fs);</span></span></span>
<span class="srcline"><span class="lineno"><a href="38,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">% Calcula las respuestas al impulso de cancelación de crosstalk</span></span></span>
<span class="srcline"><span class="lineno"><a href="38,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">% <span class="keyword">...</span><span class="comment"> (descripción sin cambios)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="38,5" id="srcline5"> 5</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="38,6" id="srcline6"> 6</a></span><span class="line"><span class="mxinfo " id="T3:U13"><span class="var type1" id="S16T3U21">c</span>=<span class="mxinfo " id="T3:U15">345</span></span>; <span class="comment">% Velocidad del sonido en m/s</span></span></span>
<span class="srcline"><span class="lineno"><a href="38,7" id="srcline7"> 7</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T5:U16"><span class="mxinfo " id="T3:U17">mod(<span class="var type1" id="S14T3U28">nSamplesIR</span>,2)</span>==<span class="mxinfo " id="T3:U19">1</span></span> </span></span>
<span class="srcline"><span class="lineno"><a href="38,8" id="srcline8"> 8</a></span><span class="line">    <span class="message error" id="M16F127C">warning(<span class="mxinfo " id="T37:U20"><span class="string">'nSamplesIR debe ser un número par. Se ha añadido 1 automáticamente.'</span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,9" id="srcline9"> 9</a></span><span class="line">    <span class="mxinfo " id="T3:U21"><span class="var type1" id="S14T3U37">nSamplesIR</span>=<span class="mxinfo " id="T3:U23"><span class="var type1" id="S14T3U39">nSamplesIR</span>+<span class="mxinfo " id="T3:U25">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,10" id="srcline10">10</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="38,11" id="srcline11">11</a></span><span class="line"><span class="mxinfo " id="T36:U26"><span class="var type1" id="S19T36U43">f</span>=<span class="mxinfo " id="T36:U28"><span class="mxinfo " id="T36:U29">(<span class="mxinfo " id="T36:U30">0:<span class="mxinfo " id="T3:U31"><span class="var type1" id="S14T3U50">nSamplesIR</span>-<span class="mxinfo " id="T3:U33">1</span></span></span>)/<span class="var type1" id="S14T3U52">nSamplesIR</span></span>*<span class="var type1" id="S15T3U53">fs</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,12" id="srcline12">12</a></span><span class="line"><span class="mxinfo " id="T3:U36"><span class="var type1" id="S20T3U56">dLL</span> = <span class="mxinfo " id="T3:U38">sqrt(<span class="mxinfo " id="T3:U39"><span class="mxinfo " id="T3:U40"><span class="var type1" id="S10T3U61">D</span>^2</span>+<span class="mxinfo " id="T3:U42">(<span class="mxinfo " id="T3:U43"><span class="mxinfo " id="T3:U44"><span class="var type1" id="S11T3U67">dp</span>/<span class="mxinfo " id="T3:U46">2</span></span>-<span class="mxinfo " id="T3:U47"><span class="var type1" id="S12T3U70">do</span>/<span class="mxinfo " id="T3:U49">2</span></span></span>)^2</span></span>)</span></span>; <span class="comment">% Distancia ipsilateral</span></span></span>
<span class="srcline"><span class="lineno"><a href="38,13" id="srcline13">13</a></span><span class="line"><span class="mxinfo " id="T3:U50"><span class="var type1" id="S22T3U75">dLR</span> = <span class="mxinfo " id="T3:U52">sqrt(<span class="mxinfo " id="T3:U53"><span class="mxinfo " id="T3:U54"><span class="var type1" id="S10T3U80">D</span>^2</span>+<span class="mxinfo " id="T3:U56">(<span class="mxinfo " id="T3:U57"><span class="mxinfo " id="T3:U58"><span class="var type1" id="S11T3U86">dp</span>/<span class="mxinfo " id="T3:U60">2</span></span>+<span class="mxinfo " id="T3:U61"><span class="var type1" id="S12T3U89">do</span>/<span class="mxinfo " id="T3:U63">2</span></span></span>)^2</span></span>)</span></span>; <span class="comment">% Distancia contralateral</span></span></span>
<span class="srcline"><span class="lineno"><a href="38,14" id="srcline14">14</a></span><span class="line"><span class="mxinfo " id="T3:U64"><span class="var type1" id="S23T3U94">tLL</span>=<span class="mxinfo " id="T3:U66"><span class="var type1" id="S20T3U96">dLL</span>/<span class="var type1" id="S16T3U97">c</span></span></span>; <span class="mxinfo " id="T3:U69"><span class="var type1" id="S24T3U100">tLR</span>=<span class="mxinfo " id="T3:U71"><span class="var type1" id="S22T3U102">dLR</span>/<span class="var type1" id="S16T3U103">c</span></span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="38,15" id="srcline15">15</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="38,16" id="srcline16">16</a></span><span class="line"><span class="comment">% Cálculo de las matrices de transferencia</span></span></span>
<span class="srcline"><span class="lineno"><a href="38,17" id="srcline17">17</a></span><span class="line"><span class="mxinfo " id="T38:U74"><span class="var type1" id="S25T38U106">H</span>=<span class="mxinfo " id="T38:U76">zeros(<span class="mxinfo " id="T3:U77">2</span>,<span class="mxinfo " id="T3:U78">2</span>,<span class="mxinfo " id="T3:U79"><span class="mxinfo " id="T3:U80"><span class="var type1" id="S14T3U113">nSamplesIR</span>/<span class="mxinfo " id="T3:U82">2</span></span>+<span class="mxinfo " id="T3:U83">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,18" id="srcline18">18</a></span><span class="line"><span class="mxinfo " id="T38:U84"><span class="var type1" id="S27T38U118">C</span>=<span class="mxinfo " id="T38:U86">zeros(<span class="mxinfo " id="T3:U87">2</span>,<span class="mxinfo " id="T3:U88">2</span>,<span class="mxinfo " id="T3:U89"><span class="mxinfo " id="T3:U90"><span class="var type1" id="S14T3U125">nSamplesIR</span>/<span class="mxinfo " id="T3:U92">2</span></span>+<span class="mxinfo " id="T3:U93">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,19" id="srcline19">19</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="38,20" id="srcline20">20</a></span><span class="line"><span class="comment">% El bucle debe ir hasta nSamplesIR/2 + 1 para incluir Nyquist</span></span></span>
<span class="srcline"><span class="lineno"><a href="38,21" id="srcline21">21</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S28T3U130">naux</span> = <span class="mxinfo " id="T35:U95"><span class="mxinfo " id="T3:U96">1</span>:(<span class="mxinfo " id="T3:U97"><span class="mxinfo " id="T3:U98"><span class="var type1" id="S14T3U136">nSamplesIR</span>/<span class="mxinfo " id="T3:U100">2</span></span>+<span class="mxinfo " id="T3:U101">1</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="38,22" id="srcline22">22</a></span><span class="line">    <span class="mxinfo " id="T3:U102"><span class="var type1" id="S29T3U141">w</span>=<span class="mxinfo " id="T3:U104"><span class="mxinfo " id="T3:U105"><span class="mxinfo " id="T3:U106">2</span>*<span class="mxinfo " id="T3:U107">pi</span></span>*<span class="mxinfo " id="T3:U108"><span class="var type1" id="S19T36U148">f</span>(<span class="var type1" id="S28T3U149">naux</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,23" id="srcline23">23</a></span><span class="line">    <span class="mxinfo " id="T39:U111"><span class="var type1" id="S31T39U152">Haux0</span>=<span class="mxinfo " id="T39:U113">[<span class="mxinfo " id="T40:U114"><span class="mxinfo " id="T41:U115"><span class="mxinfo " id="T41:U116">exp(<span class="mxinfo " id="T41:U117"><span class="mxinfo " id="T41:U118"><span class="mxinfo " id="T41:U119">-1i</span>*<span class="var type1" id="S29T3U162">w</span></span>*<span class="var type1" id="S23T3U163">tLL</span></span>)</span>/<span class="var type1" id="S20T3U164">dLL</span></span>,        <span class="mxinfo " id="T41:U123"><span class="mxinfo " id="T41:U124">exp(<span class="mxinfo " id="T41:U125"><span class="mxinfo " id="T41:U126"><span class="mxinfo " id="T41:U127">-1i</span>*<span class="var type1" id="S29T3U172">w</span></span>*<span class="var type1" id="S24T3U173">tLR</span></span>)</span>/<span class="var type1" id="S22T3U174">dLR</span></span></span>; <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="38,24" id="srcline24">24</a></span><span class="line">           <span class="mxinfo " id="T40:U131"><span class="mxinfo " id="T41:U132"><span class="mxinfo " id="T41:U133">exp(<span class="mxinfo " id="T41:U134"><span class="mxinfo " id="T41:U135"><span class="mxinfo " id="T41:U136">-1i</span>*<span class="var type1" id="S29T3U183">w</span></span>*<span class="var type1" id="S24T3U184">tLR</span></span>)</span>/<span class="var type1" id="S22T3U185">dLR</span></span>,        <span class="mxinfo " id="T41:U140"><span class="mxinfo " id="T41:U141">exp(<span class="mxinfo " id="T41:U142"><span class="mxinfo " id="T41:U143"><span class="mxinfo " id="T41:U144">-1i</span>*<span class="var type1" id="S29T3U193">w</span></span>*<span class="var type1" id="S23T3U194">tLL</span></span>)</span>/<span class="var type1" id="S20T3U195">dLL</span></span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,25" id="srcline25">25</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="38,26" id="srcline26">26</a></span><span class="line">    <span class="comment">% Inversión regularizada para obtener el filtro de cancelación</span></span></span>
<span class="srcline"><span class="lineno"><a href="38,27" id="srcline27">27</a></span><span class="line">    <span class="message error" id="M17F127C"><span class="mxinfo " id="T42:U148"><span class="var type1" id="S27T38U199">C</span>(<span class="mxinfo " id="T17:U150">:</span>,<span class="mxinfo " id="T17:U151">:</span>,<span class="var type1" id="S28T3U202">naux</span>)</span>=<span class="mxinfo " id="T39:U153"><span class="mxinfo " id="T39:U154">inv(<span class="mxinfo " id="T39:U155"><span class="mxinfo " id="T39:U156"><span class="mxinfo " id="T39:U157"><span class="var type1" id="S31T39U209">Haux0</span>'</span>*<span class="var type1" id="S31T39U210">Haux0</span></span> + <span class="mxinfo " id="T42:U160"><span class="var type1" id="S13T3U212">beta</span>*<span class="mxinfo " id="T42:U162">eye(2)</span></span></span>)</span> * <span class="mxinfo " id="T39:U163"><span class="var type1" id="S31T39U217">Haux0</span>'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,28" id="srcline28">28</a></span><span class="line">    <span class="message error" id="M18F127C"><span class="mxinfo " id="T42:U165"><span class="var type1" id="S25T38U221">H</span>(<span class="mxinfo " id="T17:U167">:</span>,<span class="mxinfo " id="T17:U168">:</span>,<span class="var type1" id="S28T3U224">naux</span>)</span>=<span class="var type1" id="S31T39U225">Haux0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,29" id="srcline29">29</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="38,30" id="srcline30">30</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="38,31" id="srcline31">31</a></span><span class="line"><span class="comment">% Reconstrucción del espectro completo (Hermitian symmetric)</span></span></span>
<span class="srcline"><span class="lineno"><a href="38,32" id="srcline32">32</a></span><span class="line"><span class="mxinfo " id="T35:U171"><span class="var type1" id="S35T35U228">CLL_spec</span> = <span class="mxinfo " id="T35:U173">[<span class="mxinfo " id="T35:U174">squeeze(<span class="mxinfo " id="T43:U175"><span class="var type1" id="S27T38U234">C</span>(<span class="mxinfo " id="T11:U177">1</span>,<span class="mxinfo " id="T11:U178">1</span>,<span class="mxinfo " id="T44:U179">:</span>)</span>)</span>; conj(<span class="mxinfo " id="T35:U180">squeeze(<span class="mxinfo " id="T43:U181"><span class="var type1" id="S27T38U244">C</span>(<span class="mxinfo " id="T11:U183">1</span>,<span class="mxinfo " id="T11:U184">1</span>,<span class="mxinfo " id="T36:U185"><span class="mxinfo " id="T3:U186"><span class="mxinfo " id="T3:U187">end</span>-<span class="mxinfo " id="T3:U188">1</span></span>:<span class="mxinfo " id="T3:U189">-1</span>:<span class="mxinfo " id="T3:U190">2</span></span>)</span>)</span>)]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,33" id="srcline33">33</a></span><span class="line"><span class="mxinfo " id="T35:U191"><span class="var type1" id="S39T35U258">CLR_spec</span> = <span class="mxinfo " id="T35:U193">[<span class="mxinfo " id="T35:U194">squeeze(<span class="mxinfo " id="T43:U195"><span class="var type1" id="S27T38U264">C</span>(<span class="mxinfo " id="T11:U197">2</span>,<span class="mxinfo " id="T11:U198">1</span>,<span class="mxinfo " id="T44:U199">:</span>)</span>)</span>; conj(<span class="mxinfo " id="T35:U200">squeeze(<span class="mxinfo " id="T43:U201"><span class="var type1" id="S27T38U274">C</span>(<span class="mxinfo " id="T11:U203">2</span>,<span class="mxinfo " id="T11:U204">1</span>,<span class="mxinfo " id="T36:U205"><span class="mxinfo " id="T3:U206"><span class="mxinfo " id="T3:U207">end</span>-<span class="mxinfo " id="T3:U208">1</span></span>:<span class="mxinfo " id="T3:U209">-1</span>:<span class="mxinfo " id="T3:U210">2</span></span>)</span>)</span>)]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,34" id="srcline34">34</a></span><span class="line"><span class="mxinfo " id="T35:U211"><span class="var type1" id="S40T35U288">CRR_spec</span> = <span class="var type1" id="S35T35U289">CLL_spec</span></span>; <span class="comment">% Por simetría</span></span></span>
<span class="srcline"><span class="lineno"><a href="38,35" id="srcline35">35</a></span><span class="line"><span class="mxinfo " id="T35:U214"><span class="var type1" id="S41T35U292">CRL_spec</span> = <span class="var type1" id="S39T35U293">CLR_spec</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,36" id="srcline36">36</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="38,37" id="srcline37">37</a></span><span class="line"><span class="mxinfo " id="T35:U217"><span class="var type1" id="S42T35U296">HLL_spec</span> = <span class="mxinfo " id="T35:U219">[<span class="mxinfo " id="T35:U220">squeeze(<span class="mxinfo " id="T43:U221"><span class="var type1" id="S25T38U302">H</span>(<span class="mxinfo " id="T11:U223">1</span>,<span class="mxinfo " id="T11:U224">1</span>,<span class="mxinfo " id="T44:U225">:</span>)</span>)</span>; conj(<span class="mxinfo " id="T35:U226">squeeze(<span class="mxinfo " id="T43:U227"><span class="var type1" id="S25T38U312">H</span>(<span class="mxinfo " id="T11:U229">1</span>,<span class="mxinfo " id="T11:U230">1</span>,<span class="mxinfo " id="T36:U231"><span class="mxinfo " id="T3:U232"><span class="mxinfo " id="T3:U233">end</span>-<span class="mxinfo " id="T3:U234">1</span></span>:<span class="mxinfo " id="T3:U235">-1</span>:<span class="mxinfo " id="T3:U236">2</span></span>)</span>)</span>)]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,38" id="srcline38">38</a></span><span class="line"><span class="mxinfo " id="T35:U237"><span class="var type1" id="S43T35U326">HLR_spec</span> = <span class="mxinfo " id="T35:U239">[<span class="mxinfo " id="T35:U240">squeeze(<span class="mxinfo " id="T43:U241"><span class="var type1" id="S25T38U332">H</span>(<span class="mxinfo " id="T11:U243">2</span>,<span class="mxinfo " id="T11:U244">1</span>,<span class="mxinfo " id="T44:U245">:</span>)</span>)</span>; conj(<span class="mxinfo " id="T35:U246">squeeze(<span class="mxinfo " id="T43:U247"><span class="var type1" id="S25T38U342">H</span>(<span class="mxinfo " id="T11:U249">2</span>,<span class="mxinfo " id="T11:U250">1</span>,<span class="mxinfo " id="T36:U251"><span class="mxinfo " id="T3:U252"><span class="mxinfo " id="T3:U253">end</span>-<span class="mxinfo " id="T3:U254">1</span></span>:<span class="mxinfo " id="T3:U255">-1</span>:<span class="mxinfo " id="T3:U256">2</span></span>)</span>)</span>)]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,39" id="srcline39">39</a></span><span class="line"><span class="mxinfo " id="T35:U257"><span class="var type1" id="S44T35U356">HRR_spec</span> = <span class="var type1" id="S42T35U357">HLL_spec</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,40" id="srcline40">40</a></span><span class="line"><span class="mxinfo " id="T35:U260"><span class="var type1" id="S45T35U360">HRL_spec</span> = <span class="var type1" id="S43T35U361">HLR_spec</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,41" id="srcline41">41</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="38,42" id="srcline42">42</a></span><span class="line"><span class="var type0" id="S8T0U365"><span class="message error" id="M19F127C">C2</span></span>(1,1,:) = <span class="var type1" id="S35T35U369">CLL_spec</span>; <span class="var type0" id="S8T0U373"><span class="message error" id="M20F127C">C2</span></span>(1,2,:) = <span class="var type1" id="S39T35U377">CLR_spec</span>; <span class="var type0" id="S8T0U381"><span class="message error" id="M21F127C">C2</span></span>(2,1,:) = <span class="var type1" id="S41T35U385">CRL_spec</span>; <span class="var type0" id="S8T0U389"><span class="message error" id="M22F127C">C2</span></span>(2,2,:) = <span class="var type1" id="S40T35U393">CRR_spec</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,43" id="srcline43">43</a></span><span class="line"><span class="var type0" id="S9T0U397"><span class="message error" id="M23F127C">H2</span></span>(1,1,:) = <span class="var type1" id="S42T35U401">HLL_spec</span>; <span class="var type0" id="S9T0U405"><span class="message error" id="M24F127C">H2</span></span>(1,2,:) = <span class="var type1" id="S43T35U409">HLR_spec</span>; <span class="var type0" id="S9T0U413"><span class="message error" id="M25F127C">H2</span></span>(2,1,:) = <span class="var type1" id="S45T35U417">HRL_spec</span>; <span class="var type0" id="S9T0U421"><span class="message error" id="M26F127C">H2</span></span>(2,2,:) = <span class="var type1" id="S44T35U425">HRR_spec</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,44" id="srcline44">44</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="38,45" id="srcline45">45</a></span><span class="line"><span class="comment">% %% CAMBIO: Usar real() para descartar residuos imaginarios por errores de precisión</span></span></span>
<span class="srcline"><span class="lineno"><a href="38,46" id="srcline46">46</a></span><span class="line"><span class="comment">% La transformada inversa de un espectro Hermítico es siempre real.</span></span></span>
<span class="srcline"><span class="lineno"><a href="38,47" id="srcline47">47</a></span><span class="line"><span class="mxinfo " id="T35:U271"><span class="var type1" id="S2T35U428">cLL</span> = <span class="mxinfo " id="T35:U273">real(<span class="mxinfo " id="T45:U274">ifft(<span class="var type1" id="S35T35U433">CLL_spec</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,48" id="srcline48">48</a></span><span class="line"><span class="mxinfo " id="T35:U276"><span class="var type1" id="S4T35U436">cLR</span> = <span class="mxinfo " id="T35:U278">real(<span class="mxinfo " id="T45:U279">ifft(<span class="var type1" id="S39T35U441">CLR_spec</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,49" id="srcline49">49</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="38,50" id="srcline50">50</a></span><span class="line"><span class="comment">% Centrar el pico de la IR para evitar 'wrap-around'</span></span></span>
<span class="srcline"><span class="lineno"><a href="38,51" id="srcline51">51</a></span><span class="line"><span class="mxinfo " id="T3:U281"><span class="var type1" id="S48T3U444">tdelay</span> = <span class="mxinfo " id="T3:U283">0.01</span></span>; <span class="comment">% 10 ms</span></span></span>
<span class="srcline"><span class="lineno"><a href="38,52" id="srcline52">52</a></span><span class="line"><span class="mxinfo " id="T3:U284"><span class="var type1" id="S49T3U448">ntdelay</span> = <span class="mxinfo " id="T3:U286">round(<span class="mxinfo " id="T3:U287"><span class="var type1" id="S48T3U452">tdelay</span> * <span class="var type1" id="S15T3U453">fs</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,53" id="srcline53">53</a></span><span class="line"><span class="mxinfo " id="T35:U290"><span class="var type1" id="S2T35U456">cLL</span> = <span class="mxinfo " id="T35:U292">circshift(<span class="var type1" id="S2T35U459">cLL</span>, <span class="var type1" id="S49T3U460">ntdelay</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,54" id="srcline54">54</a></span><span class="line"><span class="mxinfo " id="T35:U295"><span class="var type1" id="S4T35U463">cLR</span> = <span class="mxinfo " id="T35:U297">circshift(<span class="var type1" id="S4T35U466">cLR</span>, <span class="var type1" id="S49T3U467">ntdelay</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,55" id="srcline55">55</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="38,56" id="srcline56">56</a></span><span class="line"><span class="comment">% Por simetría</span></span></span>
<span class="srcline"><span class="lineno"><a href="38,57" id="srcline57">57</a></span><span class="line"><span class="mxinfo " id="T35:U300"><span class="var type1" id="S5T35U470">cRR</span> = <span class="var type1" id="S2T35U471">cLL</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="38,58" id="srcline58">58</a></span><span class="line"><span class="mxinfo " id="T35:U303"><span class="var type1" id="S3T35U474">cRL</span> = <span class="var type1" id="S4T35U475">cLR</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,59" id="srcline59">59</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="38,60" id="srcline60">60</a></span><span class="line"><span class="mxinfo " id="T3:U306"><span class="var type1" id="S7T3U478">dt</span> = <span class="mxinfo " id="T3:U308"><span class="mxinfo " id="T3:U309">1</span>/<span class="var type1" id="S15T3U481">fs</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,61" id="srcline61">61</a></span><span class="line"><span class="mxinfo " id="T36:U311"><span class="var type1" id="S6T36U484">t</span> = <span class="mxinfo " id="T36:U313">(<span class="mxinfo " id="T36:U314">0:<span class="mxinfo " id="T3:U315"><span class="mxinfo " id="T3:U316">length(<span class="var type1" id="S2T35U492">cLL</span>)</span>-<span class="mxinfo " id="T3:U318">1</span></span></span>)*<span class="var type1" id="S7T3U494">dt</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,62" id="srcline62">62</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="38,63" id="srcline63">63</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
</body>
</html>
